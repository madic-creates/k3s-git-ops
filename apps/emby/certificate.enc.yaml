apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
    name: emby-certificate
    namespace: media
    #annotations:
    #    kustomize.config.k8s.io/needs-hash: "false"
    #    kustomize.config.k8s.io/behavior: merge
spec:
    secretName: emby-certificate-pkcs12
    issuerRef:
        name: cloudflare-issuer-production
        kind: ClusterIssuer
    commonName: ENC[AES256_GCM,data:9xKE5raSM7mF47rAxDqN7tk=,iv:muI/0e2xdDkocov5mOTbbr2o+seKJrj8LrVpSQzgWrM=,tag:l88QI//TnPdl6EHtlIw7tg==,type:str]
    privateKey:
        algorithm: ECDSA
        size: 256
    dnsNames:
        - ENC[AES256_GCM,data:XlN3WpUyxXiOJ30yg8Tvsgc=,iv:UWsfORcUo35vipC0hLDtP5K0W5yiDar89npGFaF5KcU=,tag:T/SO/oJ7f6tNeNTTxE6jvw==,type:str]
    keystores:
        pkcs12:
            create: true
            passwordSecretRef:
                name: emby-certificate-secret
                key: pkcs12-password-secret
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBnaFphS1ZMc1JCNWl1UEgx
            QjJHL0tGL0krR0tqN2hoSjI3bTY1ckI5MlRjCnhjK2dMdzdrZS9ydTBHMzQvUm9r
            d3N2VW9FdzVCcTM3ZTU0WVByaUZ4VDAKLS0tIEg5VXRSa2doeCtyK3lIWnJ2SXpu
            N2hQMHR3cXZGS3dmQUE3ZjNCbk1rdlUKGtSHrwyD4vjoTkbPghflzMbb3oWJI6Aj
            87deSbTWqJk07hYykDX86I3aptBjCfjd0iN9EEcdaf/XFzgtuJwlPA==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBTUldMU1JpWC95K2dsT3FS
            SHNTa0tsclpDa1liZmsxUzhXSm1HQ2d1MTI0CnhDeGxBMnFEcVFZZ1licWtCTHJ4
            SndHZlVoVmhwQnhiamg3cTR5RFNsQkEKLS0tIGtRR29UOFZJRDhBNkt5clc1L2tV
            ekVteDBtbmN4S2VwWmM2NkdDVTE4WFkKGhcqRCc3DJn2n1kSqXek1KTas2+9XY+q
            YUCDo+4XfX/3WBRaHkNr13MAmw8tPs6+7oVX5j6mNHE4rVVb+HSExQ==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-08-03T15:13:50Z"
    mac: ENC[AES256_GCM,data:aLZV2y+fiBh0/4QR1UtIML+Zhz6sGd2nGunp5AWJEq9Dpnrt2Ga9s8Z4clddCFxbLY4m25sDjr/aVd+xLUwpD9y9wyxd5KimHX+stXNX7D00sPJnylSy5C8JDLzBJCCfUdhNf2iw9/niVRXEwCZC7/KihQ/xxSWNimmUSbD1RQM=,iv:x6bkctQfkcDI6ybW0gff+qm4FFeDprBm2kNnkptBJ0g=,tag:ToLIK3dGCckbM6I7YiANqw==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword|adminPassword|root_url|client_secret|auth_url|api_url|PIHOLE_DOMAIN|TUNNEL_DNS_UPSTREAM|customDnsEntries|securityTokenKey|emailRecipients|.*provider_url|.*redirect_url|.*accesskeyEncryption|SEMAPHORE_WEB_ROOT|token|cookieEncryption|cookieHash)$
    version: 3.10.2
---
apiVersion: v1
kind: Secret
metadata:
    name: emby-certificate-secret
    namespace: media
    #annotations:
    #    kustomize.config.k8s.io/needs-hash: "false"
    #    kustomize.config.k8s.io/behavior: merge
stringData:
    pkcs12-password-secret: ENC[AES256_GCM,data:Pj698xkgkTo+Z4q/UdSSnLkoECEZ7m+GdmVifj8d3js=,iv:v7xHSYUSgkjcogFW0XNT87flvVcr3yYk0TkZpXv3o64=,tag:TVafPBlgwc8RD/XByLcdhw==,type:str]
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBnaFphS1ZMc1JCNWl1UEgx
            QjJHL0tGL0krR0tqN2hoSjI3bTY1ckI5MlRjCnhjK2dMdzdrZS9ydTBHMzQvUm9r
            d3N2VW9FdzVCcTM3ZTU0WVByaUZ4VDAKLS0tIEg5VXRSa2doeCtyK3lIWnJ2SXpu
            N2hQMHR3cXZGS3dmQUE3ZjNCbk1rdlUKGtSHrwyD4vjoTkbPghflzMbb3oWJI6Aj
            87deSbTWqJk07hYykDX86I3aptBjCfjd0iN9EEcdaf/XFzgtuJwlPA==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBTUldMU1JpWC95K2dsT3FS
            SHNTa0tsclpDa1liZmsxUzhXSm1HQ2d1MTI0CnhDeGxBMnFEcVFZZ1licWtCTHJ4
            SndHZlVoVmhwQnhiamg3cTR5RFNsQkEKLS0tIGtRR29UOFZJRDhBNkt5clc1L2tV
            ekVteDBtbmN4S2VwWmM2NkdDVTE4WFkKGhcqRCc3DJn2n1kSqXek1KTas2+9XY+q
            YUCDo+4XfX/3WBRaHkNr13MAmw8tPs6+7oVX5j6mNHE4rVVb+HSExQ==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-08-03T15:13:50Z"
    mac: ENC[AES256_GCM,data:aLZV2y+fiBh0/4QR1UtIML+Zhz6sGd2nGunp5AWJEq9Dpnrt2Ga9s8Z4clddCFxbLY4m25sDjr/aVd+xLUwpD9y9wyxd5KimHX+stXNX7D00sPJnylSy5C8JDLzBJCCfUdhNf2iw9/niVRXEwCZC7/KihQ/xxSWNimmUSbD1RQM=,iv:x6bkctQfkcDI6ybW0gff+qm4FFeDprBm2kNnkptBJ0g=,tag:ToLIK3dGCckbM6I7YiANqw==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword|adminPassword|root_url|client_secret|auth_url|api_url|PIHOLE_DOMAIN|TUNNEL_DNS_UPSTREAM|customDnsEntries|securityTokenKey|emailRecipients|.*provider_url|.*redirect_url|.*accesskeyEncryption|SEMAPHORE_WEB_ROOT|token|cookieEncryption|cookieHash)$
    version: 3.10.2
