image:
    repository: pihole/pihole
    #tag: 2024.07.0
    pullPolicy: IfNotPresent
serviceDns:
    mixedService: true
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    # type LoadBalancer with externalTrafficPolicy Local
    # requires 192.168.1.232 on the same node as the pod
    type: LoadBalancer
    #externalTrafficPolicy: Cluster
    #type: ClusterIP
serviceDhcp:
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    type: LoadBalancer
virtualHost: ENC[AES256_GCM,data:RlEb7zBq2pUQ2h83SPLpvajkC+rRE6Q=,iv:6hRCaAVW1wA4LZtgiNb1DHWWyfOWQk6JitmPj86sJb0=,tag:hqJHIqYlQmoMlM/uvUpIFg==,type:str]
ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
        - ENC[AES256_GCM,data:XOvRZyyxrSCCy6T9eJZxcJVmMjYVON0=,iv:8BQ8aTYW8qcl0OJQGBRLxKUIuY7REQOrB1PTIeR1TGw=,tag:OFvT2pIw3vo4BLE5oVN4IQ==,type:str]
    tls:
        - secretName: wildcard-cloudflare-production-01
          hosts:
            - ENC[AES256_GCM,data:esU8+vaOUtkyoFclz1YIE/loRXFPNyc=,iv:h+Lu3g5z9pjZIXX3clxu18vdc5z4JGa8At2F8L7eQZI=,tag:0eOJ+YoQq1Mo8A4FLUQ6fw==,type:str]
    annotations:
        traefik.ingress.kubernetes.io/router.entrypoints: websecure
        traefik.ingress.kubernetes.io/router.tls: "true"
        traefik.ingress.kubernetes.io/router.middlewares: authelia-forwardauth-authelia@kubernetescrd, traefik-root-to-admin@kubernetescrd
resources:
    limits:
        cpu: 1000m
        memory: 256Mi
    requests:
        cpu: 100m
        memory: 128Mi
extraEnvVars:
    TZ: Europe/Berlin
    #FTLCONF_LOCAL_IPV4: 192.168.1.232
    #FTLCONF_dns_dnssec: true
    FTLCONF_dns_bogusPriv: true
    FTLCONF_dns_domainNeeded: true
    FTLCONF_dhcp_start: 192.168.1.50
    FTLCONF_dhcp_end: 192.168.1.200
    FTLCONF_dhcp_router: 192.168.1.1
    FTLCONF_dhcp_leaseTime: 12d
    FTLCONF_dns_domain: neese-web.de
    FTLCONF_dhcp_rapidCommit: true
    FTLCONF_webserver_interface_boxed: false
    #FTLCONF_MOZILLA_CANARY: true
    #FTLCONF_BLOCK_ICLOUD_PR: true
DNS1: 127.0.0.1:5053
# Not required because secured via authelia oidc
admin:
    enabled: false
doh:
    enabled: true
    pullPolicy: IfNotPresent
    envVars:
        TUNNEL_DNS_UPSTREAM: ENC[AES256_GCM,data:NYir1Wkt0509O541KxspiZA0+7bzo8NjMOP/R20kKyvhlF6J,iv:2j6Zq4zMSryAb/Dc+PQn0CKz3mLY/TmbSpQ7ZJlLKUw=,tag:I7ITmG5WJmeIXKplUJrH0w==,type:str]
dnsmasq:
    # Contains internal wildcard domains:
    # - address=/.example.com/192.168.1.45
    # - 'address=/.example.com/::'
    # - address=/.k8s.example.com/192.168.1.231
    # - 'address=/.k8s.example.com/::'
    customDnsEntries:
        - ENC[AES256_GCM,data:khl8SNXh/lLI9LpOLjxSm6wXczsvn+RXaUwUGtngFjC7DvA=,iv:xrc4RzvVhc+SsTmXyKOUlaOJb4ebI0cM+n1evQ9QO+A=,tag:wU3yU17B9s8zpqr+2ulsiw==,type:str]
        - ENC[AES256_GCM,data:BPUJljGyCVbInuGCD8h24W+FW4q0K9usvw==,iv:DQOx+Lx5gPc5ivbNYISI7u4DAPwGTfI93l1ep9xWDfE=,tag:hSyyb8UTZFGseEGQYn8ILQ==,type:str]
        - ENC[AES256_GCM,data:GZ4wrmdcyZlg7lMeDbBaeZbhd0P8F3M9l5UYX+xxOBAyvWWwxUSUwA==,iv:4ehDqyaI2XRCGP8bsR/3reGxSqll7KWlGASkXi/brGU=,tag:8nIoxyci35DAyLiI6x2ofA==,type:str]
        - ENC[AES256_GCM,data:0dnC2Zd32B3KSqtFg816afPp29kfIwKV+PLtvwA=,iv:b3h5DSDQyLw+YX0G9GGGPbnB35S+YmUXePTw5ctAq0k=,tag:e5izBmbtMvN7qgTsYXx8tA==,type:str]
        - ENC[AES256_GCM,data:niqlFFDJjCwZXYEmgVqbx1vFlKd9kJp0HroJPqkk5IQqsBAIJ/eqwS482fOuDHI=,iv:PV+KqjXPyfT3H2AgKZ2JjxIIMwh71bugM8LvUJF6zFM=,tag:qvQwTOizoLEYiwA/sSL9cg==,type:str]
        - ENC[AES256_GCM,data:29A/ZGchrenWUYVPEMKxHWEVLQ2C/Laeg2E65Lse4tH9Of2GehL0tBDyKiXXCJGtMOekr5Q0,iv:HWe5DTMsGDpkbL6l44i3112Irmz0fE/G00NOOnUOaVo=,tag:JJj8dueQaPpwWkp9xDhM0Q==,type:str]
        - ENC[AES256_GCM,data:8FwEODOYcLmu1HH988uYETEuPjgaL2yCTvFZVF6R6HhqFW8PQ1VB,iv:nryzkCgfeaUQwYJBFpOtfDW4JUyy3W+m2pn4/MhXdWc=,tag:yrQrbPYVg1001lCIeypRWQ==,type:str]
        - ENC[AES256_GCM,data:M4tRiNO+h2KZcuSSwZdN3rWDsKBwLq8H0g6nQfBgdSFznmONyBUC6/fruWWoew==,iv:L6Ch9fP6hfaZrILbTaz/v8rqkm8/0CgiCDiF8zhmc0Q=,tag:zHUfuZvO2B+x3X0gqyox8g==,type:str]
        - ENC[AES256_GCM,data:Kc0d8X5sbw56g798/WCunXVZNEgj/WI4AT5nUpi99P7RUoMyIQ==,iv:jxdspnnCeveojUktmgJ4Xfa73IkfK6o08tIX83acXVM=,tag:orVjESnYR0os09NviU2uLw==,type:str]
        - ENC[AES256_GCM,data:DIQhsh6I2Yf8bySbLU16adu8JgJES6oOVw3BUJqb/cR7RVl0iblyPfjVACM=,iv:xpnoGwF4omMYkTPJcmcF/b4ep6qDlCLi4ddAYfphzvE=,tag:W/+wG6PRpt1mBV9j6X9wBA==,type:str]
        - ENC[AES256_GCM,data:iNuzosn7PydnoHDCnnE6w8goduCEUmbtRU8Asw1kNzUWVdLM65xmhUQaW6R5oA==,iv:k2X1HnUaVLCiw41SOjmcivgL6YLr60ig4zk3/+bZudw=,tag:7bNRG+Cw9UWACM1p6XqEAQ==,type:str]
        - ENC[AES256_GCM,data:VQ5Dx10kC0Csmy9KzhZJzyzQZ/EaKz8hUyxwKao9mRJ7EY8VhQoSNa0AAppKm35LSK3fd1A=,iv:DzUWVgyEGnvEL8WP144G8fFUVBVtjUixEG57r9u8Hls=,tag:9rnBD8FeNpWVbFE/Yt3CfQ==,type:str]
        - ENC[AES256_GCM,data:twqAYqCK4nC8m5LbDFBTvZ9aMSiSID9MKJuu1whmLcwinkBJW/1CdZU/odXtN+po,iv:ZKSSZttmtG6wzpnYFSYoe2sWbbhhWP8HTuB+Qa0ZK2k=,tag:wNNl/Zr5fTyBAI5b08YPsA==,type:str]
        - ENC[AES256_GCM,data:TvDjgB/l57BzdAqVqzx27XGpoBm38wozdgpW06etz/A56FDHMPyqfAKPiUiFez3xg5fw54juAA==,iv:Dxgxwm/7MLurIsEngHTKIoPbwfU0aa3irspBlsCzmI0=,tag:HPu0jCiqxuFjsEiYbUTwig==,type:str]
    customSettings:
        - dhcp-option=252,"\n"
        - dhcp-option=vendor:MSFT,2,1i
        # DNS
        #- dhcp-option=6,192.168.1.232,192.168.1.1
        - dhcp-option=6,192.168.1.232,192.168.1.234
        # NTP
        - dhcp-option=42,192.168.1.1
        - dhcp-range=::,ra-names
        - server=/geekbundle.org/192.168.1.1
        - ptr-record=1.1.168.192.in-addr.arpa.,"despair"
        # TFTP Boot
        - dhcp-match=set:ipxe,175
        - dhcp-boot=tag:!ipxe,ipxe.pxe,dns01,192.168.1.11
        - dhcp-match=set:efi-x86_64,option:client-arch,7
        - dhcp-boot=tag:efi-x86_64,ipxe.efi,dns01,192.168.1.11
        - dhcp-boot=http://192.168.1.45:8043/boot.ipxe
        # DHCP Reservation with different dns server
        - dhcp-option=net:customdns,6,9.9.9.9,1.1.1.1
        - dhcp-host=net:customdns,EC:79:49:51:64:16,192.168.1.187,ipl06002-lan
        - dhcp-host=net:customdns,F4:4E:E3:2C:C2:B6,192.168.1.56,ipl06002-wlan
        # DHCP Reservation with unrestricted youtube dns server
        - dhcp-option=net:youtubedns,6,192.168.1.234
        - dhcp-host=net:youtubedns,AC:3E:B1:A6:AF:D6,Pixel-7-Pro
        - dhcp-host=net:youtubedns,74:58:F3:E7:3A:04,Fire-Cube-lan
        - dhcp-host=net:youtubedns,48:43:DD:6E:CC:2D,Fire-Cube-wlan
        # HTTP Boot
        #- dhcp-match=set:efi-x86_64_http,option:vendor-class-identifier,0,10
        #- dhcp-boot=tag:efi-x86_64_http,"http://192.168.1.45:8043/ipxe.efi"
        #- dhcp-boot=tag:!ipxe,"http://192.168.1.45:8043/ipxe.pxe"
    #customCnameEntries:
    #- cname=www.youtube.com,restrict.youtube.com
    #- cname=m.youtube.com,restrict.youtube.com
    #- cname=youtubei.googleapis.com,restrict.youtube.com
    #- cname=youtube.googleapis.com,restrict.youtube.com
    #- cname=www.youtube-nocookie.com,restrict.youtube.com
# Not required. We're running a dhcp relay via host network.
#hostNetwork: "true"
capabilities:
    add:
        - NET_ADMIN
        - CAP_SYS_TIME
        - CAP_SYS_NICE
persistentVolumeClaim:
    enabled: true
    existingClaim: pihole
    #storageClass: longhorn
    #size: "10737418240"
podDnsConfig:
    enabled: true
    policy: None
    nameservers:
        - 127.0.0.1
        - 1.1.1.1
#affinity:
#  nodeAffinity:
#    requiredDuringSchedulingIgnoredDuringExecution:
#      nodeSelectorTerms:
#        - matchExpressions:
#            - key: kubernetes.io/hostname
#              operator: In
#              values:
#                - node03
probes:
    liveness:
        initialDelaySeconds: 30
    readiness:
        initialDelaySeconds: 30
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBpeHZnNDBVTkl0OGloYk5t
            amhPOXNERjFHdjU4QzBuY0tlZFBRQjA4YXlnCkM2UFc1L0pHaFFQTTlVbG1mVzVv
            aVJ0NHZrL0VvQzUwUnlJQ3VKUm9aMDgKLS0tIFg0ekRyNUJ5Zk9NNHlzSVdsTkEr
            M1FEaFFhMWlTb1VxNzhkU0JxT01ocUUKr9MeVqFo1n2JK9YB6+J0+pc8LfA0Te1G
            Ynv2aivKHNZjn81Wbp0ad3/qT59qOJoXO2OhVlMzzMHyzvPC1nnVeQ==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB5TlFHbW1kb3JGdEJKR1ZY
            akhmNGtWQjA5OHp2ZWs3RmpwQS9weE9RNmdRCkZSckFyRW1GWmdRTitDS0ZBOGlN
            LytIL3pid0lIMUZJSXRsNHkwOHRDcEkKLS0tIERkY1RHVk9BUUtOMFdFVHFWRVlJ
            dUxKRzhBTDVnRnZldzltQnVzMlA2aEkKnrkMbwUI93M+QP0MSsGbCenT2UnTiw/i
            zitZyDHkF4xmowSHskAiQJF08k/u9oR4UOljCly7jnvsZP6OF6zGww==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-23T18:36:43Z"
    mac: ENC[AES256_GCM,data:8N6ZMqOeMymNADUZiPJbKEII9eub0amtXXgECY6QbshS10DVLcqNIwTDZEi+oZfzAHCM8/del3AEKKji056y7Y+vFqgcFIS9IqUWXV0FPnZATeeek3EaYNpCr76OBH813y4z2DNQFSxx7DPs66eQj4SHs47ejknYUK1bZDxPd2Q=,iv:SSR6cCMUDfsQGEoypPXwC7CX7YeZvWs6Mm303e5CScU=,tag:pxaeeLeQUydPgfCL9LGLOA==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword|adminPassword|root_url|client_secret|auth_url|api_url|PIHOLE_DOMAIN|TUNNEL_DNS_UPSTREAM|customDnsEntries|securityTokenKey|emailRecipients|.*provider_url|.*redirect_url|.*accesskeyEncryption|SEMAPHORE_WEB_ROOT|token|cookieEncryption|cookieHash)$
    version: 3.10.2
