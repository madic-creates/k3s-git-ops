image:
    repository: pihole/pihole
    #tag: 2024.07.0
    pullPolicy: IfNotPresent
serviceDns:
    mixedService: true
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    # type LoadBalancer with externalTrafficPolicy Local
    # requires 192.168.1.232 on the same node as the pod
    type: LoadBalancer
    #externalTrafficPolicy: Cluster
    #type: ClusterIP
serviceDhcp:
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    type: LoadBalancer
virtualHost: ENC[AES256_GCM,data:as3uwLQ0n0h81Ii1aChbO3UxJywLrEI=,iv:uFMJIB3fYTNpQ9WWeOd+qzWTJAFlYoK9pPSaOeOHG2M=,tag:jOgQc9ip0fkClFLC5EeLoA==,type:str]
ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
        - ENC[AES256_GCM,data:a6hf8jqKqQLpBc6JIo5CCuflyMPHvtg=,iv:4+dEDWKUdXqVYwMFGgqu8hTYmJslyZiPFP9BZ7SzTYk=,tag:a6rj9lrXA1LeE6u5f4V0pg==,type:str]
    tls:
        - secretName: wildcard-cloudflare-production-01
          hosts:
            - ENC[AES256_GCM,data:rNzYwRJJA+vfICIpt0kLwYCiqYaaVHQ=,iv:HEkGBbIXeQuuJAy1tEzM8CbHAJEMp6iaDWzWpxYIMcQ=,tag:pW0acQszLJFzfLNTEl/wVQ==,type:str]
    annotations:
        traefik.ingress.kubernetes.io/router.entrypoints: websecure
        traefik.ingress.kubernetes.io/router.tls: "true"
        traefik.ingress.kubernetes.io/router.middlewares: authelia-forwardauth-authelia@kubernetescrd, traefik-root-to-admin@kubernetescrd
resources:
    limits:
        cpu: 1000m
        memory: 256Mi
    requests:
        cpu: 100m
        memory: 128Mi
extraEnvVars:
    TZ: Europe/Berlin
    #FTLCONF_LOCAL_IPV4: 192.168.1.232
    #FTLCONF_dns_dnssec: true
    FTLCONF_dns_bogusPriv: true
    FTLCONF_dns_domainNeeded: true
    FTLCONF_dhcp_start: 192.168.1.50
    FTLCONF_dhcp_end: 192.168.1.200
    FTLCONF_dhcp_router: 192.168.1.1
    FTLCONF_dhcp_leaseTime: 12d
    FTLCONF_dns_domain: neese-web.de
    FTLCONF_dhcp_rapidCommit: true
    FTLCONF_webserver_interface_boxed: false
    #FTLCONF_MOZILLA_CANARY: true
    #FTLCONF_BLOCK_ICLOUD_PR: true
DNS1: 127.0.0.1:5053
# Not required because secured via authelia oidc
admin:
    enabled: false
doh:
    enabled: true
    pullPolicy: IfNotPresent
    envVars:
        TUNNEL_DNS_UPSTREAM: ENC[AES256_GCM,data:9ns8+Aul/f5da1p3vSjrfm7OeUKnevkpSqfW4Ewqt7bMpruq,iv:P1rQbFWI5wTky+vrbtIpD+Gsotavn9RnGwnncOAY/L4=,tag:RmQnEuRNAi1cTeRaaaP5aQ==,type:str]
dnsmasq:
    # Contains internal wildcard domains:
    # - address=/.example.com/192.168.1.45
    # - 'address=/.example.com/::'
    # - address=/.k8s.example.com/192.168.1.231
    # - 'address=/.k8s.example.com/::'
    customDnsEntries:
        - ENC[AES256_GCM,data:ung00Hm7i8DAyc0a/0ch0bor4M5k+FdxUG40NqKzV0tSGLA=,iv:W3XF/olshpIyTeAG+hJLlB/W7uPxOX/jmDh/gAQsdcc=,tag:WH5EQAUzFfeKGmxaGD9XZA==,type:str]
        - ENC[AES256_GCM,data:YgYnnPPR1L+EwRHkv3DbPKaEJfNBOpmADg==,iv:0PbzWF0xixprJzP2hDVP1j2tIHG/CuGAyGO/B+EtD0Y=,tag:DZqIg5g89uCscvl4+9lzmA==,type:str]
        - ENC[AES256_GCM,data:TGDloB5Z+vVlrNJ0KEJwRUuUkIG5IUkb74MdTCNG+MOmQ1t0eZ7KlQ==,iv:XbNrWHziGgEc9gDqWPOl4Y0IslvxOCNYG0bOwvwr2XM=,tag:eZhupuEJfNLQZwkaNgASvA==,type:str]
        - ENC[AES256_GCM,data:MbrI+PymyWxYJ/ro9OM0MaT3e/UxlXL0whRXDeQ=,iv:eekOcATzCZKX+ziM+KFUY25lxbmN2ASkz8vjOgiWCKs=,tag:xyBR7syYWfqEzb29jE+B0A==,type:str]
        - ENC[AES256_GCM,data:I8mLCJ0W/MZJnczNA3kjIaRDcBWS24Jbj7B3k6VBawqzIth8fhGi3C1PSf0=,iv:GC3z+pgc6EKCQ7NMDVoCc68o2DN2I7TmVVjVKlmx0I4=,tag:1MrpSd0Cq7n/dud6z1U/lA==,type:str]
        - ENC[AES256_GCM,data:xY805r9gJXjbpuXHs5LtkhlnPIp6x/UJydbYtF2f2cu7+EFLOmAjIkvc21o+Bw+5zO30,iv:I6oB/hnIaaOqPfLgRXIwBh1oyBVRYMdJo33+lb7VmOQ=,tag:Ph9qkv4t28NCvHzfs1hUAg==,type:str]
        - ENC[AES256_GCM,data:pnApT/gwarvzdNp1/HYR2Zj5fv9Yb7tkCuNJJ2umsYantYT9vnt1OlgPwvdYvJM=,iv:8s7GBflWPNQ73RX+a3ow48UTCkkOWdkeIBpWcCeK2nI=,tag:mPUAkv+1yecwLgsOH5Y5yw==,type:str]
        - ENC[AES256_GCM,data:MRNK7rIf7RiR0rDgav8irCdQ5DJePz6G0cXrQvoR2Z0dbvuWHcSGxDl/fcQejfmMrxnGzJ4b,iv:tqcbX9kVjZWgavdvVj36BRoVNjx5OoNNFEWfKKrByeg=,tag:LsGSpxFS/j9UE/gavQbLcQ==,type:str]
        - ENC[AES256_GCM,data:m8TWJMi3pYHrDPU1Gd7T/vGEmZRP7eCVg/sLZLTtwqfxfv3vwaPw,iv:62vKnGQed/eJ/7yCCPVSkbS8ykNn07CYMQ6sd19kCLs=,tag:gjSCSXkJOw6QlH7xnV7Jrg==,type:str]
        - ENC[AES256_GCM,data:CCfpDEc7gWPmOsMxTSgcLfQV0ZHK1dosnzM2TKHO617J1KlSQxlWy5rM3ScemQ==,iv:GKVGVRSN+d3PBQB1RM/Mf/hKuGQSYXc06RNPG2MKmFY=,tag:jXqfhWnHZEr2FatBB+XpUQ==,type:str]
        - ENC[AES256_GCM,data:BU+TiDjMjj8IfGttpcjp2uXVKr5tpn7rc05NAO8rodXqHXufJw==,iv:eualvb46a8y19lN7ZnJPJramhvIWL04yLS0o6hLP+ug=,tag:eih8YhZkLD+V/2ewCHg2yw==,type:str]
        - ENC[AES256_GCM,data:kk7V/M4wn1MhrvfCsdTTJvCt9JUrzBKwuoj36fo6Ltim37D2/JkW2vste3w=,iv:HImbUyWxH3Yu8JnfAm+nJXrKezKYAbtABbI8UQFAavo=,tag:MG8P9bUCmNWnoM8zIWqDzQ==,type:str]
        - ENC[AES256_GCM,data:zzRXoheHXdUFIg4dMGF3p4SQMtbTVho+Fy7sS7TwoCG3PO6DF9ZMQh80PM8PDQ==,iv:SC633MgMULCAjtufOqK0WgMArJOLFIWNXA6IAz7ROjk=,tag:oVI9iVJFlJpuC3vtMtZQRw==,type:str]
        - ENC[AES256_GCM,data:JGyEOs98J/bHAVRBeS3rzzvl+3Cbm8iLSi3ycj1FrqIBYN/qWz0IvK3udrQ0ccmfot7UZUU=,iv:ubAdQdfs1c56+/HCEc17eBTPnRZh6sQCSGSsysfHr1o=,tag:Spfw/lHRqKhwu2zACwNWYw==,type:str]
        - ENC[AES256_GCM,data:jxEffqBbdh7J//5y4BZQU9o2tbTfPnJ950/MihmLGWovEW8hHR3yFD+ErWa3QtTx,iv:W8XgrYWIIlFsmQrJZi4880SOwyngvCke4PTc0qMsL28=,tag:fnjX3T4DnumPRPanHVJbrA==,type:str]
        - ENC[AES256_GCM,data:RjK0iAKkhPAW1XLSm+4R4TGj7O7dSOk6UHbjz+I1J6BapPN7TY5SHoCHE+dNE43K/2S1h0Lwvw==,iv:GyJQuvCY7wgiaatr3RyXmhTdnCkShJbPHzChH1ZBZN8=,tag:iqx98OtFvvUFJeYXTd849Q==,type:str]
    customSettings:
        - dhcp-option=252,"\n"
        - dhcp-option=vendor:MSFT,2,1i
        # DNS
        #- dhcp-option=6,192.168.1.232,192.168.1.1
        - dhcp-option=6,192.168.1.232,192.168.1.234
        # NTP
        - dhcp-option=42,192.168.1.1
        - dhcp-range=::,ra-names
        - server=/geekbundle.org/192.168.1.1
        - ptr-record=1.1.168.192.in-addr.arpa.,"despair"
        # TFTP Boot
        - dhcp-match=set:ipxe,175
        - dhcp-boot=tag:!ipxe,ipxe.pxe,dns01,192.168.1.11
        - dhcp-match=set:efi-x86_64,option:client-arch,7
        - dhcp-boot=tag:efi-x86_64,ipxe.efi,dns01,192.168.1.11
        - dhcp-boot=http://192.168.1.45:8043/boot.ipxe
        # DHCP Reservation with different dns server
        - dhcp-option=net:customdns,6,9.9.9.9,1.1.1.1
        - dhcp-host=net:customdns,EC:79:49:51:64:16,192.168.1.187,ipl06002-lan
        - dhcp-host=net:customdns,F4:4E:E3:2C:C2:B6,192.168.1.56,ipl06002-wlan
        # DHCP Reservation with unrestricted youtube dns server
        - dhcp-option=net:youtubedns,6,192.168.1.234
        - dhcp-host=net:youtubedns,AC:3E:B1:A6:AF:D6,Pixel-7-Pro
        - dhcp-host=net:youtubedns,74:58:F3:E7:3A:04,Fire-Cube-lan
        - dhcp-host=net:youtubedns,48:43:DD:6E:CC:2D,Fire-Cube-wlan
        # HTTP Boot
        #- dhcp-match=set:efi-x86_64_http,option:vendor-class-identifier,0,10
        #- dhcp-boot=tag:efi-x86_64_http,"http://192.168.1.45:8043/ipxe.efi"
        #- dhcp-boot=tag:!ipxe,"http://192.168.1.45:8043/ipxe.pxe"
    #customCnameEntries:
    #- cname=www.youtube.com,restrict.youtube.com
    #- cname=m.youtube.com,restrict.youtube.com
    #- cname=youtubei.googleapis.com,restrict.youtube.com
    #- cname=youtube.googleapis.com,restrict.youtube.com
    #- cname=www.youtube-nocookie.com,restrict.youtube.com
# Not required. We're running a dhcp relay via host network.
#hostNetwork: "true"
capabilities:
    add:
        - NET_ADMIN
        - CAP_SYS_TIME
        - CAP_SYS_NICE
persistentVolumeClaim:
    enabled: true
    existingClaim: pihole
    #storageClass: longhorn
    #size: "10737418240"
podDnsConfig:
    enabled: true
    policy: None
    nameservers:
        - 127.0.0.1
        - 1.1.1.1
#affinity:
#  nodeAffinity:
#    requiredDuringSchedulingIgnoredDuringExecution:
#      nodeSelectorTerms:
#        - matchExpressions:
#            - key: kubernetes.io/hostname
#              operator: In
#              values:
#                - node03
probes:
    liveness:
        initialDelaySeconds: 30
    readiness:
        initialDelaySeconds: 30
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBoZ1dSVzJZMXV0NEJJUExr
            VElZalZMbzh2eGFoR1l3R3ZPQzNnaGljZlZvClpwc0p5dmZpT0JOOHJuWG1PZUdU
            WUozaEZIWFRieGlHcnRhTmlUSFJ6ZFEKLS0tIC9GY0k1K0VWb3JGOXMyYnFyVDBF
            c0MxcU01aDdOc3VCSU9JcU5lQXNVMVEKE9jkdKeFlYaUbxzpoRaNLtb8dN+aQEBg
            fvdgZeWgXceN3hajNDVH3dtjaQ467BpLUq9KMnGvGEx886vtAOCBIw==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBJS29MQ21uL1J3WE5wV0Zo
            akJJcHU3bFFXdmt6eTg1d1FRKzB0QkhsT1hZCmFLUytyclo3Y0tyMkFtaitBNWI1
            YnYwS09UeGpjTlZhYkNoMnBzR0poNFUKLS0tIHE0VU5tc1BXemJVM25rWEFkWkps
            aXMvbG83RTVEeTFERFczQ0twREdJSTgKCWXa8M3OsD0TOMRSnZh/TrCLj15Yro4T
            AMf3Uwix+MYR1EHeRW6+a9AIN+zVYrgO+/2vA0g/jlg2cLXZfHRM8A==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-23T18:30:34Z"
    mac: ENC[AES256_GCM,data:LFH/Y73MNUY1gt+yWA2lH8DppsNFXcga35k9aGoXi4JVtnDOx2C9J/6KsYF7R7d+u4JYGYrbCHypmI3WfzgnescjhtoI1zrEcW+DB0za8p04C9/Fy/4zAJ9mFzHtqona36i4sqsM/4VPpMvVy+ZaNC1ITkBVhLJnd7NiV97cr9M=,iv:CoX8CterjVBq5Aw4PySIH4iNbEGWAmCzkr/61pXxZEk=,tag:sNlgyqGn72dhBluF+TDREw==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword|adminPassword|root_url|client_secret|auth_url|api_url|PIHOLE_DOMAIN|TUNNEL_DNS_UPSTREAM|customDnsEntries|securityTokenKey|emailRecipients|.*provider_url|.*redirect_url|.*accesskeyEncryption|SEMAPHORE_WEB_ROOT|token|cookieEncryption|cookieHash)$
    version: 3.10.2
