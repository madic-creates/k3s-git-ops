image:
    repository: pihole/pihole
    #tag: 2024.07.0
    pullPolicy: IfNotPresent
serviceDns:
    mixedService: true
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    # type LoadBalancer with externalTrafficPolicy Local
    # requires 192.168.1.232 on the same node as the pod
    type: LoadBalancer
    #externalTrafficPolicy: Cluster
    #type: ClusterIP
serviceDhcp:
    annotations:
        kube-vip.io/loadbalancerIPs: 192.168.1.232
    type: LoadBalancer
virtualHost: ENC[AES256_GCM,data:4q3r1cr0OoMYuggmfuwjg5cuVtz8hkc=,iv:rq9fNCyS7IWhxOH4EIUXeShxRtaFq1Zflb2TYm1jGuk=,tag:dV38Txh5l673zLuAv7xtJA==,type:str]
ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
        - ENC[AES256_GCM,data:DLG8wVYz5BHCJtUvTXXfvzLoFM+CJ3k=,iv:L3pQwY3FLzMWCp2lv/ozGZSJFQ9ElMgTYuZierUawQ0=,tag:vgW4kMCMaD5ZKt9DkEKaRA==,type:str]
    tls:
        - secretName: wildcard-cloudflare-production-01
          hosts:
            - ENC[AES256_GCM,data:qvetC5p+5R8TWO5PguOvlCdlMAOqrhY=,iv:j8WVCw//ytYhiWNnGgVh0lI/DKM/yKfA6HB5Z34QfrI=,tag:TZqiik34CzBmeQQ8GDWbPA==,type:str]
    annotations:
        traefik.ingress.kubernetes.io/router.entrypoints: websecure
        traefik.ingress.kubernetes.io/router.tls: "true"
        traefik.ingress.kubernetes.io/router.middlewares: authelia-forwardauth-authelia@kubernetescrd, traefik-root-to-admin@kubernetescrd
resources:
    limits:
        cpu: 1000m
        memory: 256Mi
    requests:
        cpu: 100m
        memory: 128Mi
extraEnvVars:
    TZ: Europe/Berlin
    #FTLCONF_LOCAL_IPV4: 192.168.1.232
    #FTLCONF_dns_dnssec: true
    FTLCONF_dns_bogusPriv: true
    FTLCONF_dns_domainNeeded: true
    FTLCONF_dhcp_start: 192.168.1.50
    FTLCONF_dhcp_end: 192.168.1.200
    FTLCONF_dhcp_router: 192.168.1.1
    FTLCONF_dhcp_leaseTime: 12d
    FTLCONF_dns_domain: neese-web.de
    FTLCONF_dhcp_rapidCommit: true
    FTLCONF_webserver_interface_boxed: false
    #FTLCONF_MOZILLA_CANARY: true
    #FTLCONF_BLOCK_ICLOUD_PR: true
DNS1: 127.0.0.1:5053
# Not required because secured via authelia oidc
admin:
    enabled: false
doh:
    enabled: true
    pullPolicy: IfNotPresent
    envVars:
        TUNNEL_DNS_UPSTREAM: ENC[AES256_GCM,data:VrE5ECUCzwZrojVBFCLYsME64AkUyFTsFIFhavT9Mb2nTFHg,iv:yDAU8asjGL6f1dfLms8YN2ouy1WxK49EnUacjr2Nb1s=,tag:uxgbz9OnD6Ng16/bkTpE6g==,type:str]
dnsmasq:
    # Contains internal wildcard domains:
    # - address=/.example.com/192.168.1.45
    # - 'address=/.example.com/::'
    # - address=/.k8s.example.com/192.168.1.231
    # - 'address=/.k8s.example.com/::'
    customDnsEntries:
        - ENC[AES256_GCM,data:Lw5r/JZi93KaTP+1AuQ+L9tAYcIHYAER9/8v2X8McDNcM1E=,iv:dHQSe4hd61sqS29LQ/YUL8vn0R5epXZVW7eiWVy2feE=,tag:fKdTh4qoAzI1L4c+Y4T5BA==,type:str]
        - ENC[AES256_GCM,data:2lbIKhsRMpnkg+XQvMpyRHqEmYSOWhrHHQ==,iv:GEXO4PN272AwX/3eBHPYtosWKpjVK7z9T7ryIDW8Fak=,tag:nCoqaxTuiwkhsmJZPne3+A==,type:str]
        - ENC[AES256_GCM,data:QyqX2GSt6d2H29q4e71jzuRrdrC8ET5DBCDEDkBdVLArttjT2D2qqg==,iv:7YwoYrzOvOTvERLI45D/8rxJwSYYgDElv2KGSnHhj/Y=,tag:MH2tpluZA4AKoeqGGRooRw==,type:str]
        - ENC[AES256_GCM,data:XJ5yGD5CJt3QbD98tWzle4nxIi1eRvnzfIPctqE=,iv:TJU5BsC5SSTAXriR8as9fqH4xut3rkwX+woW2zRoNh0=,tag:gPJ5/SxTjXzhHejlu9If5Q==,type:str]
        - ENC[AES256_GCM,data:ihO1ZLqrb0hYgo3XfvL4Tg3edoite90hIACzzNitiNALrZa5JCp2kJBQpso=,iv:cfWhk1qK1SjJi8E849nvyZ0XfYtZbZ5oouLW3u01nG0=,tag:M4dHqVl0HkQ2fVedj7IOHg==,type:str]
        - ENC[AES256_GCM,data:zaTV2olArNQfp5+UgfSE74nTFsyvAxbPcb+oBoca0C3immzuUUkHw+0a/lTXpTZzNw3X,iv:WOoklw0m2h8+grFfea4Uqr5hBcOx0Z4E7Bv6zLnBqGo=,tag:b1BVncOTESWTNVuHPxymhQ==,type:str]
        - ENC[AES256_GCM,data:VzIZHaPA3tFuXC6AuINjyZ+49uuaMPV9IdjN+i2+Vlpi7FCM62pEGICypjlMDtI=,iv:0MRKZllBVCAkCZF8nxr1VNxAAzzd9gxpZuiNmaaHR0E=,tag:CSiIOiX6U9Hp3CqqSZl+2A==,type:str]
        - ENC[AES256_GCM,data:pX31ggtzHCAJDc8+e90Bjr3UrjIArWbnNbO95fUbiB/TpPdaIPZlxYK3k9viylWLukaaHfNf,iv:Dh7VHNqj++woLZ4k2RqOQ3Q9l4ZF+6AzaS59YCv6mmQ=,tag:hXE6Y4fP3xPvFcDZRr8M7g==,type:str]
        - ENC[AES256_GCM,data:vdp7ztgbYxtje5Va9Ua3ZL/aI2JW2UiCGJsqFDqY5Rsz0OGVR1q/,iv:mQILPIpwSrOkId8aW+8+XntazWwqzI/Fu/OhFnini4g=,tag:DKEviUUhrCMN/hMdixCV6Q==,type:str]
        - ENC[AES256_GCM,data:+P3Ir3AlheLAfAgNtqTmtRsph2eHobaWc9IcnCrcuuTwe7z3KxgibZzOqBZXXA==,iv:kvMkB9GCdseoghxhWBOTJGCCys5lKENpDe0wfLv+r0w=,tag:UvsrUTadnkMAoybT77vE+Q==,type:str]
    customSettings:
        - dhcp-option=252,"\n"
        - dhcp-option=vendor:MSFT,2,1i
        # DNS
        #- dhcp-option=6,192.168.1.232,192.168.1.1
        - dhcp-option=6,192.168.1.232,192.168.1.234
        # NTP
        - dhcp-option=42,192.168.1.1
        - dhcp-range=::,ra-names
        - server=/geekbundle.org/192.168.1.1
        - ptr-record=1.1.168.192.in-addr.arpa.,"despair"
        # TFTP Boot
        - dhcp-match=set:ipxe,175
        - dhcp-boot=tag:!ipxe,ipxe.pxe,dns01,192.168.1.11
        - dhcp-match=set:efi-x86_64,option:client-arch,7
        - dhcp-boot=tag:efi-x86_64,ipxe.efi,dns01,192.168.1.11
        - dhcp-boot=http://192.168.1.45:8043/boot.ipxe
        # DHCP Reservation with different dns server
        - dhcp-option=net:customdns,6,9.9.9.9,1.1.1.1
        - dhcp-host=net:customdns,EC:79:49:51:64:16,192.168.1.187,ipl06002-lan
        - dhcp-host=net:customdns,F4:4E:E3:2C:C2:B6,192.168.1.56,ipl06002-wlan
        # DHCP Reservation with unrestricted youtube dns server
        - dhcp-option=net:youtubedns,6,192.168.1.234
        - dhcp-host=net:youtubedns,AC:3E:B1:A6:AF:D6,Pixel-7-Pro
        - dhcp-host=net:youtubedns,74:58:F3:E7:3A:04,Fire-Cube-lan
        - dhcp-host=net:youtubedns,48:43:DD:6E:CC:2D,Fire-Cube-wlan
        # HTTP Boot
        #- dhcp-match=set:efi-x86_64_http,option:vendor-class-identifier,0,10
        #- dhcp-boot=tag:efi-x86_64_http,"http://192.168.1.45:8043/ipxe.efi"
        #- dhcp-boot=tag:!ipxe,"http://192.168.1.45:8043/ipxe.pxe"
    customCnameEntries:
        #- cname=www.youtube.com,restrict.youtube.com
        - cname=m.youtube.com,restrict.youtube.com
        #- cname=youtubei.googleapis.com,restrict.youtube.com
        - cname=youtube.googleapis.com,restrict.youtube.com
        - cname=www.youtube-nocookie.com,restrict.youtube.com
# Not required. We're running a dhcp relay via host network.
#hostNetwork: "true"
capabilities:
    add:
        - NET_ADMIN
        - CAP_SYS_TIME
        - CAP_SYS_NICE
persistentVolumeClaim:
    enabled: true
    existingClaim: pihole
    #storageClass: longhorn
    #size: "10737418240"
podDnsConfig:
    enabled: true
    policy: None
    nameservers:
        - 127.0.0.1
        - 1.1.1.1
#affinity:
#  nodeAffinity:
#    requiredDuringSchedulingIgnoredDuringExecution:
#      nodeSelectorTerms:
#        - matchExpressions:
#            - key: kubernetes.io/hostname
#              operator: In
#              values:
#                - node03
probes:
    liveness:
        initialDelaySeconds: 30
    readiness:
        initialDelaySeconds: 30
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAxdkhiZERMeEFseVFITnJa
            WWsycjJqbVV2aW5TRzh4N1dqR1ZsK3BabjE0CnI4WXJ5bFhUWGo0RXdiZ3grYStR
            clR4M1Y4WWZ5dVE5RnlaamlLVjJ0SU0KLS0tIFZ0ZDVFMlJzR3RKRzE1UTMvaCtK
            M2dTMDgyVDRpNTVwaTg0eXYxazJSbm8KjnMx20KP9YdGBneirnTVLyLcF3VAGV7v
            rmlXrabp0ELG+K4TkjGv6NQ8UGKV4mCoNvkMpIpBbNfOn8fwMmcAiQ==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSA2VzlhNWk2eDlBbWRBRVR2
            M3h1V2xkM29ycUNmR0pDNGJCbkdhOVVpUkRZCkxWT3BESHlrYytFRUNqeG1uYVRQ
            TkpBTDlwZEhWZlRMWGlFYmNRNTU5YUEKLS0tIHNMTEY4VnVBdi85VWJtcTA1NzE4
            QW81Z1Rpd2dXNTRTVmtlUUY4UjF0VmsKHLRgb2bD2QMqGzfmXuvqZJwOI2oozwCG
            NgbkX00iBduQqAkzzOJkCKFxddmEjIzQN4xXNZ3N4B1iElOC1fHo8w==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-23T18:24:33Z"
    mac: ENC[AES256_GCM,data:4DM+1T7eYYEJbOWy+fHdiQj2XgVq0nYlSgR1jcf8zNFDfyjcgVcG4hBfpOzFXgJvH5pMN+xOVu7aKqVCLp9ZoLxAKcOj3+5zlITB0jxSsqwbSAjVt95Crv4qnJvDO0Zh/XKWt3RRud1LerJUGWVU8Emx9R1GLhhsdUO/t8VB6sU=,iv:hh/rT31MeaDocFyce8k7K/GugoxjhfDZu6Q9mBgmj6E=,tag:yP5nLc1KkXAjXLpDsY/WyQ==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword|adminPassword|root_url|client_secret|auth_url|api_url|PIHOLE_DOMAIN|TUNNEL_DNS_UPSTREAM|customDnsEntries|securityTokenKey|emailRecipients|.*provider_url|.*redirect_url|.*accesskeyEncryption|SEMAPHORE_WEB_ROOT|token|cookieEncryption|cookieHash)$
    version: 3.10.2
