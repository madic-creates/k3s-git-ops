# HTTPS Ingress
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: prometheus
    namespace: monitoring
    annotations:
        # HTTPS as entry point
        traefik.ingress.kubernetes.io/router.entrypoints: web239,websecure239
        # Enable TLS
        traefik.ingress.kubernetes.io/router.tls: "true"
        traefik.ingress.kubernetes.io/router.middlewares: authelia-forwardauth-authelia@kubernetescrd
spec:
    tls:
        - hosts:
            - ENC[AES256_GCM,data:DLSayGl3B4JAVdBy2n4K3rId3Yj3LQgfoWxkEW+0Bqg=,iv:hwO1ISlfI6h/ObQlQjaj2kqVHTFO8meAkLHyxE7tA68=,tag:wXHhwpHEqGQFbtIwZLH4RQ==,type:str]
          secretName: wildcard-cloudflare-production-02
    rules:
        - host: ENC[AES256_GCM,data:qKAT7u2vCh0ES+E5iyIt0aR9uxd73/Zhr5ApC3rM+1k=,iv:0velgLLdfWsXMVK28QquGdehu8zbCP7Q0Lhimw2Xvag=,tag:ZWL+7HgLng8bKdGa6zxL3w==,type:str]
          http:
            paths:
                - path: /
                  pathType: Prefix
                  backend:
                    service:
                        name: kube-prometheus-stack-prometheus
                        port:
                            number: 9090
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBneXFkNldzZFVUd09xWkxn
            Q1pCbUlWdE9lZ0NBRk4xc01ycnBia1BGVUdRCklGb2Nzd1U5eFBzR3UwNGsrcm9l
            KzNsdjFpUEc5LzB0N0gxZlZvQkxndzgKLS0tIFFkSmJSK0NYa1o4b2czUDJGZHBM
            MHFBTHhpSCtNZ2V5UVlpQjNtelBSdW8KKzHjWoaBJp6u+Ugj/zpY7zdjPc2onhV0
            OT0geDXzkdHZFeRVl72c35XHGyFanhri4EGnNB3Sej4S8iqt7qk9fw==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBmY2FTODJ4WFlHQkxFdTlX
            VndyS0UyOG9XZmVaclFUTC85dWRVbHBmNngwCnZmclQ0ZEpYSkV1UFhqVnRiWjBB
            b1lSMlBzRUplZ2lZT2xBWWFRQ25qMEUKLS0tIGlhaE9VNndVelpWSS9IbkZsa0ZQ
            eUQxNnpkSlY4WitJVGNVdWYzamRBelEKP55vOFsqSWbROplMZt/xq4SFZcNrOWxm
            ANJRF1aNmvugqFvnKxoPOChOuw6+AtdDduLIWARe8qC+ddEzmBQPxw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-10-13T19:43:41Z"
    mac: ENC[AES256_GCM,data:0Ki+Dbgn6g6utRhe35oO7WNR/Q05mPJBja/XGo0kXeAWYF2rxA/RTCW82rq6q8WdrcFovHZg2oO5E/agpaTo+kJE3gNY2gfFCIc1uI2cVP5XRheG65Tmglp1OdikiEO34CWQY2F5dNp0VHM2xxADH4Y+qvMFR8Rlia1otYE65Dw=,iv:e462wtkmYIBUzo4cnyVrAfPKVO+rPcDs2pSJ4jEUlUU=,tag:O5RTZhrkyv4XZWGyV8yG+Q==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword)$
    version: 3.11.0
---
# HTTPS Ingress
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: grafana
    namespace: monitoring
    annotations:
        # HTTPS as entry point
        traefik.ingress.kubernetes.io/router.entrypoints: web239,websecure239
        # Enable TLS
        traefik.ingress.kubernetes.io/router.tls: "true"
        #traefik.ingress.kubernetes.io/router.middlewares: authelia-forwardauth-authelia@kubernetescrd
spec:
    tls:
        - hosts:
            - ENC[AES256_GCM,data:WVyJLg40rb+KolAVWIE2aQCpGXf0TGBg9lppe/s=,iv:h9uRNHT0faYeYn+VCZ5X239KMQd4daHnL8iJgiTIBTA=,tag:X5BnkKtG9mvlvHBYFmevjQ==,type:str]
          secretName: wildcard-cloudflare-production-02
    rules:
        - host: ENC[AES256_GCM,data:Yja0FT/r5k4N+i9QvVL1W05W/B1AebHplRgZcfg=,iv:EK3dGM3s1gmO5+4D7RdA/KslTRQKbIH5viLK6xSGkCk=,tag:PRGZirCjw8ayQ3ma/RppaA==,type:str]
          http:
            paths:
                - path: /
                  pathType: Prefix
                  backend:
                    service:
                        name: kube-prometheus-stack-grafana
                        port:
                            number: 80
sops:
    age:
        - recipient: age1d2g7tgqpfvxulsusn3m608h60h2hne7yqwv5nh5nd24z6h0hgq0skjkhw8
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBneXFkNldzZFVUd09xWkxn
            Q1pCbUlWdE9lZ0NBRk4xc01ycnBia1BGVUdRCklGb2Nzd1U5eFBzR3UwNGsrcm9l
            KzNsdjFpUEc5LzB0N0gxZlZvQkxndzgKLS0tIFFkSmJSK0NYa1o4b2czUDJGZHBM
            MHFBTHhpSCtNZ2V5UVlpQjNtelBSdW8KKzHjWoaBJp6u+Ugj/zpY7zdjPc2onhV0
            OT0geDXzkdHZFeRVl72c35XHGyFanhri4EGnNB3Sej4S8iqt7qk9fw==
            -----END AGE ENCRYPTED FILE-----
        - recipient: age1q522xtgjrmvr43w7um5rh02ta3yfns635680hz4m7uhw0nfqj5zqgxnz27
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBmY2FTODJ4WFlHQkxFdTlX
            VndyS0UyOG9XZmVaclFUTC85dWRVbHBmNngwCnZmclQ0ZEpYSkV1UFhqVnRiWjBB
            b1lSMlBzRUplZ2lZT2xBWWFRQ25qMEUKLS0tIGlhaE9VNndVelpWSS9IbkZsa0ZQ
            eUQxNnpkSlY4WitJVGNVdWYzamRBelEKP55vOFsqSWbROplMZt/xq4SFZcNrOWxm
            ANJRF1aNmvugqFvnKxoPOChOuw6+AtdDduLIWARe8qC+ddEzmBQPxw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-10-13T19:43:41Z"
    mac: ENC[AES256_GCM,data:0Ki+Dbgn6g6utRhe35oO7WNR/Q05mPJBja/XGo0kXeAWYF2rxA/RTCW82rq6q8WdrcFovHZg2oO5E/agpaTo+kJE3gNY2gfFCIc1uI2cVP5XRheG65Tmglp1OdikiEO34CWQY2F5dNp0VHM2xxADH4Y+qvMFR8Rlia1otYE65Dw=,iv:e462wtkmYIBUzo4cnyVrAfPKVO+rPcDs2pSJ4jEUlUU=,tag:O5RTZhrkyv4XZWGyV8yG+Q==,type:str]
    encrypted_regex: ^(data|stringData|email|dnsNames|.*(H|h)osts?|hostname|username|password|url|issuer|argocdServerAdminPassword|oidc.config|commonName|literals|.*awsAccessKeyId|.*awsSecretAccessKey|.*defaultAdminPassword|apiToken|accountId|rootPassword|replicationPassword)$
    version: 3.11.0
